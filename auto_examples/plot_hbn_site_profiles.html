
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Harmonize HBN data using ComBat &#8212; AFQ-Insight 0.6 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/css/afqinsight.css?v=d1d1afb3" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=ec806d2c"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/copybutton.js?v=26522df0"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/plot_hbn_site_profiles';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Load and interact with an AFQ dataset" href="demo_afq_dataset.html" />
    <link rel="prev" title="General examples" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">AFQ-Insight 0.6 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    General examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_help.html">
    Getting help using AFQ-Insight
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../contributing.html">
    Contributing to AFQ-Insight
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/tractometry/AFQ-Insight">
    AFQ-Insight on GitHub
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    General examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_help.html">
    Getting help using AFQ-Insight
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing to AFQ-Insight
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/tractometry/AFQ-Insight">
    AFQ-Insight on GitHub
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Harmonize HBN data using ComBat</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo_afq_dataset.html">Load and interact with an AFQ dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_age_regression.html">Predict age from white matter features</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_als_comparison.html">Use parametric statistics for group comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_als_classification.html">Classify ALS diagnosis from white matter features</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">General examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Harmonize...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-hbn-site-profiles-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="harmonize-hbn-data-using-combat">
<span id="sphx-glr-auto-examples-plot-hbn-site-profiles-py"></span><h1>Harmonize HBN data using ComBat<a class="headerlink" href="#harmonize-hbn-data-using-combat" title="Link to this heading">#</a></h1>
<p>This example loads AFQ data from the Healthy Brain Network (HBN) preprocessed
diffusion derivatives <a class="footnote-reference brackets" href="#id3" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. The HBN is a landmark pediatric mental health study.
Over the course of the study, it will collect diffusion MRI data from
approximately 5,000 children and adolescents. We recently processed the
available data from over 2,000 of these subjects, and provide the tract profiles
from this dataset, which can be downloaded from AWS thanks to
[INDI](<a class="reference external" href="http://fcon_1000.projects.nitrc.org/">http://fcon_1000.projects.nitrc.org/</a>).</p>
<p>We first load the data by using the <code class="xref py py-func docutils literal notranslate"><span class="pre">AFQDataset.from_files()</span></code> static method
and supplying AWS S3 URIs instead of local file names. We then impute missing
values and plot the mean bundle profiles by scanning site, noting that there are
substantial site differences. Lastly, we harmonize the site differences using
NeuroComBat <a class="footnote-reference brackets" href="#id4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and plot the harmonized bundle profiles to verify that the site
differences have been removed.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Adam Richie-Halford, Matthew Cieslak, Lei Ai, Sendy Caffarra, Sydney
Covitz, Alexandre R. Franco, Iliana I. Karipidis, John Kruper, Michael
Milham, Bárbara Avelar-Pereira, Ethan Roy, Valerie J. Sydnor, Jason Yeatman,
The Fibr Community Science Consortium, Theodore D. Satterthwaite, and Ariel
Rokem,
“An open, analysis-ready, and quality controlled resource for pediatric brain
white-matter research”
bioRxiv 2022.02.24.481303;
doi: <a class="reference external" href="https://doi.org/10.1101/2022.02.24.481303">https://doi.org/10.1101/2022.02.24.481303</a></p>
</aside>
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Jean-Philippe Fortin, Drew Parker, Birkan Tunc, Takanori Watanabe, Mark A
Elliott, Kosha Ruparel, David R Roalf, Theodore D Satterthwaite, Ruben C Gur,
Raquel E Gur, Robert T Schultz, Ragini Verma, Russell T Shinohara.
“Harmonization Of Multi-Site Diffusion Tensor Imaging Data”
NeuroImage, 161, 149-170, 2017;
doi: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2017.08.047">https://doi.org/10.1016/j.neuroimage.2017.08.047</a></p>
</aside>
</aside>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">neurocombat_sklearn</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator" title="sklearn.base.BaseEstimator" class="sphx-glr-backref-module-sklearn-base sphx-glr-backref-type-py-class"><span class="n">CombatModel</span></a>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="sklearn.impute.SimpleImputer" class="sphx-glr-backref-module-sklearn-impute sphx-glr-backref-type-py-class"><span class="n">SimpleImputer</span></a>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html#sklearn.model_selection.train_test_split" title="sklearn.model_selection.train_test_split" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-function"><span class="n">train_test_split</span></a>

<span class="kn">from</span> <span class="nn">afqinsight</span> <span class="kn">import</span> <span class="n">AFQDataset</span>
<span class="kn">from</span> <span class="nn">afqinsight.plot</span> <span class="kn">import</span> <span class="n">plot_tract_profiles</span>
</pre></div>
</div>
<section id="fetch-the-hbn-data">
<h2>Fetch the HBN data<a class="headerlink" href="#fetch-the-hbn-data" title="Link to this heading">#</a></h2>
<p>As a shortcut, we have incorporated a few studies  into the software. In these
cases, a <code class="xref py py-class docutils literal notranslate"><span class="pre">AFQDataset</span></code> class instance can be initialized using the
<code class="xref py py-func docutils literal notranslate"><span class="pre">AFQDataset.from_study()</span></code> static method. This expects the name of one of
the studies that are supported (see the method documentation for the list of
these studies). By passing <cite>“hbn”</cite>, we request that the object download the
HBN dataset from the AWS Open Data program where it has been stored and
initialize the objects with the subjects and nodes information. Subjects’ age
is set as the target variable. After dropping subjects that don’t have their
age recorded, there are 1867 subjects in the dataset.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <span class="n">AFQDataset</span><span class="o">.</span><span class="n">from_study</span><span class="p">(</span><span class="s2">&quot;hbn&quot;</span><span class="p">)</span>
<a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="o">.</span><span class="n">drop_target_na</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>subjects.tsv:   0%|          | 0.00/211k [00:00&lt;?, ?iB/s]
subjects.tsv: 100%|██████████| 211k/211k [00:00&lt;00:00, 11.7MiB/s]

nodes.csv:   0%|          | 0.00/543M [00:00&lt;?, ?iB/s]
nodes.csv:   0%|          | 490k/543M [00:00&lt;01:53, 4.79MiB/s]
nodes.csv:   0%|          | 1.39M/543M [00:00&lt;01:15, 7.13MiB/s]
nodes.csv:   0%|          | 2.61M/543M [00:00&lt;00:58, 9.31MiB/s]
nodes.csv:   1%|          | 3.87M/543M [00:00&lt;00:51, 10.4MiB/s]
nodes.csv:   1%|          | 5.24M/543M [00:00&lt;00:46, 11.6MiB/s]
nodes.csv:   1%|          | 6.62M/543M [00:00&lt;00:43, 12.2MiB/s]
nodes.csv:   2%|▏         | 8.18M/543M [00:00&lt;00:40, 13.2MiB/s]
nodes.csv:   2%|▏         | 9.78M/543M [00:00&lt;00:37, 14.0MiB/s]
nodes.csv:   2%|▏         | 11.6M/543M [00:00&lt;00:35, 15.2MiB/s]
nodes.csv:   2%|▏         | 13.3M/543M [00:01&lt;00:33, 15.9MiB/s]
nodes.csv:   3%|▎         | 15.3M/543M [00:01&lt;00:30, 17.2MiB/s]
nodes.csv:   3%|▎         | 17.4M/543M [00:01&lt;00:28, 18.2MiB/s]
nodes.csv:   4%|▎         | 19.6M/543M [00:01&lt;00:27, 19.3MiB/s]
nodes.csv:   4%|▍         | 21.9M/543M [00:01&lt;00:25, 20.4MiB/s]
nodes.csv:   4%|▍         | 24.3M/543M [00:01&lt;00:24, 21.4MiB/s]
nodes.csv:   5%|▍         | 26.9M/543M [00:01&lt;00:22, 22.9MiB/s]
nodes.csv:   5%|▌         | 29.6M/543M [00:01&lt;00:21, 23.9MiB/s]
nodes.csv:   6%|▌         | 32.2M/543M [00:01&lt;00:20, 24.8MiB/s]
nodes.csv:   6%|▋         | 35.2M/543M [00:01&lt;00:19, 26.2MiB/s]
nodes.csv:   7%|▋         | 38.3M/543M [00:02&lt;00:18, 27.5MiB/s]
nodes.csv:   8%|▊         | 41.4M/543M [00:02&lt;00:17, 28.4MiB/s]
nodes.csv:   8%|▊         | 44.5M/543M [00:02&lt;00:17, 29.3MiB/s]
nodes.csv:   9%|▉         | 48.0M/543M [00:02&lt;00:15, 31.0MiB/s]
nodes.csv:   9%|▉         | 51.5M/543M [00:02&lt;00:15, 32.1MiB/s]
nodes.csv:  10%|█         | 55.1M/543M [00:02&lt;00:14, 33.1MiB/s]
nodes.csv:  11%|█         | 58.6M/543M [00:02&lt;00:14, 33.8MiB/s]
nodes.csv:  11%|█▏        | 62.2M/543M [00:02&lt;00:13, 34.4MiB/s]
nodes.csv:  12%|█▏        | 66.2M/543M [00:02&lt;00:13, 36.1MiB/s]
nodes.csv:  13%|█▎        | 70.3M/543M [00:02&lt;00:12, 37.4MiB/s]
nodes.csv:  14%|█▎        | 74.5M/543M [00:03&lt;00:12, 38.8MiB/s]
nodes.csv:  15%|█▍        | 78.8M/543M [00:03&lt;00:11, 40.0MiB/s]
nodes.csv:  15%|█▌        | 83.2M/543M [00:03&lt;00:11, 41.2MiB/s]
nodes.csv:  16%|█▌        | 87.6M/543M [00:03&lt;00:10, 41.9MiB/s]
nodes.csv:  17%|█▋        | 92.0M/543M [00:03&lt;00:10, 42.5MiB/s]
nodes.csv:  18%|█▊        | 96.4M/543M [00:03&lt;00:10, 42.8MiB/s]
nodes.csv:  19%|█▊        | 101M/543M [00:03&lt;00:09, 44.2MiB/s]
nodes.csv:  20%|█▉        | 106M/543M [00:03&lt;00:09, 46.6MiB/s]
nodes.csv:  21%|██        | 112M/543M [00:03&lt;00:08, 48.1MiB/s]
nodes.csv:  21%|██▏       | 117M/543M [00:03&lt;00:08, 49.1MiB/s]
nodes.csv:  22%|██▏       | 122M/543M [00:04&lt;00:08, 49.8MiB/s]
nodes.csv:  23%|██▎       | 127M/543M [00:04&lt;00:08, 50.6MiB/s]
nodes.csv:  24%|██▍       | 132M/543M [00:04&lt;00:08, 51.2MiB/s]
nodes.csv:  25%|██▌       | 138M/543M [00:04&lt;00:07, 51.5MiB/s]
nodes.csv:  26%|██▋       | 144M/543M [00:04&lt;00:07, 54.0MiB/s]
nodes.csv:  28%|██▊       | 150M/543M [00:04&lt;00:07, 55.8MiB/s]
nodes.csv:  29%|██▊       | 156M/543M [00:04&lt;00:06, 57.1MiB/s]
nodes.csv:  30%|██▉       | 161M/543M [00:04&lt;00:06, 57.3MiB/s]
nodes.csv:  31%|███       | 167M/543M [00:04&lt;00:06, 58.3MiB/s]
nodes.csv:  32%|███▏      | 173M/543M [00:04&lt;00:06, 57.6MiB/s]
nodes.csv:  33%|███▎      | 179M/543M [00:05&lt;00:06, 58.5MiB/s]
nodes.csv:  34%|███▍      | 186M/543M [00:05&lt;00:05, 61.1MiB/s]
nodes.csv:  36%|███▌      | 193M/543M [00:05&lt;00:05, 63.2MiB/s]
nodes.csv:  37%|███▋      | 200M/543M [00:05&lt;00:05, 64.5MiB/s]
nodes.csv:  38%|███▊      | 206M/543M [00:05&lt;00:05, 65.4MiB/s]
nodes.csv:  39%|███▉      | 213M/543M [00:05&lt;00:04, 66.5MiB/s]
nodes.csv:  41%|████      | 220M/543M [00:05&lt;00:04, 67.4MiB/s]
nodes.csv:  42%|████▏     | 227M/543M [00:05&lt;00:04, 68.6MiB/s]
nodes.csv:  43%|████▎     | 235M/543M [00:05&lt;00:04, 70.9MiB/s]
nodes.csv:  45%|████▍     | 243M/543M [00:05&lt;00:04, 72.2MiB/s]
nodes.csv:  46%|████▌     | 250M/543M [00:06&lt;00:04, 73.1MiB/s]
nodes.csv:  48%|████▊     | 258M/543M [00:06&lt;00:03, 74.6MiB/s]
nodes.csv:  49%|████▉     | 266M/543M [00:06&lt;00:03, 75.1MiB/s]
nodes.csv:  50%|█████     | 274M/543M [00:06&lt;00:03, 76.3MiB/s]
nodes.csv:  52%|█████▏    | 281M/543M [00:06&lt;00:03, 77.1MiB/s]
nodes.csv:  53%|█████▎    | 290M/543M [00:06&lt;00:03, 79.3MiB/s]
nodes.csv:  55%|█████▍    | 298M/543M [00:06&lt;00:03, 81.1MiB/s]
nodes.csv:  57%|█████▋    | 307M/543M [00:06&lt;00:02, 82.4MiB/s]
nodes.csv:  58%|█████▊    | 316M/543M [00:06&lt;00:02, 83.5MiB/s]
nodes.csv:  60%|█████▉    | 324M/543M [00:06&lt;00:02, 84.3MiB/s]
nodes.csv:  61%|██████▏   | 333M/543M [00:07&lt;00:02, 84.9MiB/s]
nodes.csv:  63%|██████▎   | 342M/543M [00:07&lt;00:02, 85.7MiB/s]
nodes.csv:  65%|██████▍   | 351M/543M [00:07&lt;00:02, 88.1MiB/s]
nodes.csv:  66%|██████▋   | 360M/543M [00:07&lt;00:02, 88.4MiB/s]
nodes.csv:  68%|██████▊   | 369M/543M [00:07&lt;00:01, 90.0MiB/s]
nodes.csv:  70%|██████▉   | 379M/543M [00:07&lt;00:01, 91.6MiB/s]
nodes.csv:  71%|███████▏  | 388M/543M [00:07&lt;00:01, 92.1MiB/s]
nodes.csv:  73%|███████▎  | 398M/543M [00:07&lt;00:01, 93.3MiB/s]
nodes.csv:  75%|███████▌  | 408M/543M [00:07&lt;00:01, 94.8MiB/s]
nodes.csv:  77%|███████▋  | 418M/543M [00:07&lt;00:01, 96.8MiB/s]
nodes.csv:  79%|███████▉  | 428M/543M [00:08&lt;00:01, 98.3MiB/s]
nodes.csv:  81%|████████  | 438M/543M [00:08&lt;00:01, 99.5MiB/s]
nodes.csv:  83%|████████▎ | 448M/543M [00:08&lt;00:01, 91.5MiB/s]
nodes.csv:  84%|████████▍ | 458M/543M [00:08&lt;00:00, 93.7MiB/s]
nodes.csv:  86%|████████▌ | 468M/543M [00:08&lt;00:01, 74.2MiB/s]
nodes.csv:  88%|████████▊ | 476M/543M [00:09&lt;00:01, 37.1MiB/s]
nodes.csv:  89%|████████▊ | 482M/543M [00:09&lt;00:01, 38.6MiB/s]
nodes.csv:  90%|████████▉ | 487M/543M [00:09&lt;00:02, 27.0MiB/s]
nodes.csv:  91%|█████████ | 493M/543M [00:09&lt;00:01, 28.2MiB/s]
nodes.csv:  92%|█████████▏| 497M/543M [00:09&lt;00:01, 28.5MiB/s]
nodes.csv:  93%|█████████▎| 503M/543M [00:10&lt;00:01, 33.9MiB/s]
nodes.csv:  93%|█████████▎| 508M/543M [00:10&lt;00:01, 32.7MiB/s]
nodes.csv:  94%|█████████▍| 512M/543M [00:10&lt;00:00, 34.1MiB/s]
nodes.csv:  95%|█████████▍| 516M/543M [00:10&lt;00:00, 33.2MiB/s]
nodes.csv:  96%|█████████▌| 519M/543M [00:10&lt;00:00, 23.8MiB/s]
nodes.csv:  97%|█████████▋| 527M/543M [00:11&lt;00:00, 24.8MiB/s]
nodes.csv:  98%|█████████▊| 530M/543M [00:11&lt;00:00, 21.2MiB/s]
nodes.csv:  99%|█████████▊| 535M/543M [00:11&lt;00:00, 23.1MiB/s]
nodes.csv:  99%|█████████▉| 538M/543M [00:11&lt;00:00, 21.5MiB/s]
nodes.csv: 100%|█████████▉| 542M/543M [00:11&lt;00:00, 25.1MiB/s]
nodes.csv: 100%|██████████| 543M/543M [00:11&lt;00:00, 46.4MiB/s]
AFQDataset(n_samples=1867, n_features=4800, n_targets=3, targets=[&#39;age&#39;, &#39;sex&#39;, &#39;scan_site_id&#39;])
</pre></div>
</div>
</section>
<section id="train-test-split">
<h2>Train / test split<a class="headerlink" href="#train-test-split" title="Link to this heading">#</a></h2>
<p>We can pass the <code class="xref py py-class docutils literal notranslate"><span class="pre">AFQDataset</span></code> class instance to scikit-learn’s
<code class="xref py py-func docutils literal notranslate"><span class="pre">train_test_split()</span></code> function, just as we would with an array.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span></a><span class="p">,</span> <a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html#sklearn.model_selection.train_test_split" title="sklearn.model_selection.train_test_split" class="sphx-glr-backref-module-sklearn-model_selection sphx-glr-backref-type-py-function"><span class="n">train_test_split</span></a><span class="p">(</span><a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="impute-missing-values">
<h2>Impute missing values<a class="headerlink" href="#impute-missing-values" title="Link to this heading">#</a></h2>
<p>Next we impute missing values using median imputation. We fit the imputer
using the training set and then use it to transform both the training and test
sets.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="sklearn.impute.SimpleImputer" class="sphx-glr-backref-module-sklearn-impute sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">imputer</span></a> <span class="o">=</span> <a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span></a><span class="o">.</span><span class="n">model_fit</span><span class="p">(</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="sklearn.impute.SimpleImputer" class="sphx-glr-backref-module-sklearn-impute sphx-glr-backref-type-py-class"><span class="n">SimpleImputer</span></a><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">))</span>
<a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span></a> <span class="o">=</span> <a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span></a><span class="o">.</span><span class="n">model_transform</span><span class="p">(</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="sklearn.impute.SimpleImputer" class="sphx-glr-backref-module-sklearn-impute sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">imputer</span></a><span class="p">)</span>
<a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span></a> <span class="o">=</span> <a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span></a><span class="o">.</span><span class="n">model_transform</span><span class="p">(</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer" title="sklearn.impute.SimpleImputer" class="sphx-glr-backref-module-sklearn-impute sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">imputer</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-average-bundle-profiles-by-scan-site">
<h2>Plot average bundle profiles by scan site<a class="headerlink" href="#plot-average-bundle-profiles-by-scan-site" title="Link to this heading">#</a></h2>
<p>Next we plot the mean bundle profiles in the test set by scanning site. The
<code class="xref py py-func docutils literal notranslate"><span class="pre">plot_tract_profiles()</span></code> function takes as input an <code class="xref py py-class docutils literal notranslate"><span class="pre">AFQDataset</span></code> and
returns matplotlib figures displaying the mean bundle profile for each bundle
and metric, optionally grouped by a categorical or continuous variable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">site_figs</span></a> <span class="o">=</span> <span class="n">plot_tract_profiles</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span></a><span class="p">,</span>
    <span class="n">group_by</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span><span class="o">.</span><span class="n">classes</span></a><span class="p">[</span><span class="s2">&quot;scan_site_id&quot;</span><span class="p">][</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)],</span>
    <span class="n">group_by_name</span><span class="o">=</span><span class="s2">&quot;Site&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_hbn_site_profiles_001.png" srcset="../_images/sphx_glr_plot_hbn_site_profiles_001.png" alt="IFOL, UNCL, UNCR, IFOR, ATRL, CSTL, CSTR, ATRR, ARCL, SLFL, SLFR, ARCR, ILFL, CGCL, CGCR, ILFR, Orbital, AntFrontal, SupFrontal, Motor, SupParietal, Temporal, PostParietal, Occipital" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_hbn_site_profiles_002.png" srcset="../_images/sphx_glr_plot_hbn_site_profiles_002.png" alt="IFOL, UNCL, UNCR, IFOR, ATRL, CSTL, CSTR, ATRR, ARCL, SLFL, SLFR, ARCR, ILFL, CGCL, CGCR, ILFR, Orbital, AntFrontal, SupFrontal, Motor, SupParietal, Temporal, PostParietal, Occipital" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/2 [00:00&lt;?, ?it/s]

  0%|          | 0/24 [00:00&lt;?, ?it/s]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  4%|▍         | 1/24 [00:03&lt;01:25,  3.73s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  8%|▊         | 2/24 [00:07&lt;01:22,  3.73s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 12%|█▎        | 3/24 [00:11&lt;01:17,  3.71s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 17%|█▋        | 4/24 [00:14&lt;01:13,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 21%|██        | 5/24 [00:18&lt;01:10,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 25%|██▌       | 6/24 [00:22&lt;01:06,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 29%|██▉       | 7/24 [00:25&lt;01:02,  3.67s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 33%|███▎      | 8/24 [00:29&lt;00:58,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 38%|███▊      | 9/24 [00:33&lt;00:55,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 42%|████▏     | 10/24 [00:36&lt;00:51,  3.67s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 46%|████▌     | 11/24 [00:40&lt;00:47,  3.67s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 50%|█████     | 12/24 [00:44&lt;00:44,  3.67s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 54%|█████▍    | 13/24 [00:47&lt;00:40,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 58%|█████▊    | 14/24 [00:51&lt;00:36,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 62%|██████▎   | 15/24 [00:55&lt;00:33,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 67%|██████▋   | 16/24 [00:58&lt;00:29,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 71%|███████   | 17/24 [01:02&lt;00:25,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 75%|███████▌  | 18/24 [01:06&lt;00:22,  3.77s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 79%|███████▉  | 19/24 [01:10&lt;00:18,  3.76s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 83%|████████▎ | 20/24 [01:14&lt;00:14,  3.74s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 88%|████████▊ | 21/24 [01:17&lt;00:11,  3.72s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 92%|█████████▏| 22/24 [01:21&lt;00:07,  3.72s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 96%|█████████▌| 23/24 [01:25&lt;00:03,  3.73s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


100%|██████████| 24/24 [01:28&lt;00:00,  3.73s/it]
100%|██████████| 24/24 [01:28&lt;00:00,  3.70s/it]

 50%|█████     | 1/2 [01:29&lt;01:29, 89.97s/it]

  0%|          | 0/24 [00:00&lt;?, ?it/s]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  4%|▍         | 1/24 [00:03&lt;01:26,  3.75s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  8%|▊         | 2/24 [00:07&lt;01:22,  3.76s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 12%|█▎        | 3/24 [00:11&lt;01:18,  3.71s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 17%|█▋        | 4/24 [00:14&lt;01:13,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 21%|██        | 5/24 [00:18&lt;01:09,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 25%|██▌       | 6/24 [00:22&lt;01:06,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 29%|██▉       | 7/24 [00:25&lt;01:02,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 33%|███▎      | 8/24 [00:29&lt;00:58,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 38%|███▊      | 9/24 [00:33&lt;00:55,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 42%|████▏     | 10/24 [00:36&lt;00:51,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 46%|████▌     | 11/24 [00:40&lt;00:47,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 50%|█████     | 12/24 [00:44&lt;00:44,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 54%|█████▍    | 13/24 [00:47&lt;00:40,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 58%|█████▊    | 14/24 [00:51&lt;00:36,  3.70s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 62%|██████▎   | 15/24 [00:55&lt;00:33,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 67%|██████▋   | 16/24 [00:59&lt;00:29,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 71%|███████   | 17/24 [01:02&lt;00:26,  3.76s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 75%|███████▌  | 18/24 [01:06&lt;00:22,  3.74s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 79%|███████▉  | 19/24 [01:10&lt;00:18,  3.72s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 83%|████████▎ | 20/24 [01:13&lt;00:14,  3.70s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 88%|████████▊ | 21/24 [01:17&lt;00:11,  3.70s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 92%|█████████▏| 22/24 [01:21&lt;00:07,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 96%|█████████▌| 23/24 [01:25&lt;00:03,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


100%|██████████| 24/24 [01:28&lt;00:00,  3.67s/it]
100%|██████████| 24/24 [01:28&lt;00:00,  3.69s/it]

100%|██████████| 2/2 [02:59&lt;00:00, 89.80s/it]
100%|██████████| 2/2 [02:59&lt;00:00, 89.83s/it]
</pre></div>
</div>
</section>
<section id="harmonize-the-sites-and-replot">
<h2>Harmonize the sites and replot<a class="headerlink" href="#harmonize-the-sites-and-replot" title="Link to this heading">#</a></h2>
<p>We can see that there are substantial scan site differences in both the
FA and MD profiles. Let’s use neuroComBat to harmonize the site differences
and then replot the mean bundle profiles.</p>
<p>N.B. We use the excellent <a class="reference external" href="https://github.com/Warvito/neurocombat_sklearn">neurocombat_sklearn</a> package to apply ComBat to
our data. We love this library, however, it is not fully compliant with the
scikit-learn transformer API, so we cannot use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">AFQDataset.model_fit_transform()</span></code> method to apply this transformer to our
dataset. No problem! We can simply copy the unharmonized dataset into a new
variable and then overwrite the features of the new dataset with the ComBat
output.</p>
<p>Lastly, we replot the mean bundle profiles and confirm that ComBat did its
job.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the ComBat transformer to the training set</span>
<span class="n">combat</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator" title="sklearn.base.BaseEstimator" class="sphx-glr-backref-module-sklearn-base sphx-glr-backref-type-py-class"><span class="n">CombatModel</span></a><span class="p">()</span>
<span class="n">combat</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span><span class="o">.</span><span class="n">X</span></a><span class="p">,</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">][:,</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis" title="numpy.newaxis" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">],</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis" title="numpy.newaxis" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">],</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_train</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis" title="numpy.newaxis" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># And then transform a copy of the test set</span>
<a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">harmonized_test</span></a> <span class="o">=</span> <a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span></a><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">harmonized_test</span><span class="o">.</span><span class="n">X</span></a> <span class="o">=</span> <span class="n">combat</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span><span class="o">.</span><span class="n">X</span></a><span class="p">,</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">][:,</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis" title="numpy.newaxis" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">],</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis" title="numpy.newaxis" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">],</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset_test</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.newaxis" title="numpy.newaxis" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span></a><span class="p">],</span>
<span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">site_figs</span></a> <span class="o">=</span> <span class="n">plot_tract_profiles</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><a href="../api.html#afqinsight.AFQDataset" title="afqinsight.AFQDataset" class="sphx-glr-backref-module-afqinsight sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">harmonized_test</span></a><span class="p">,</span>
    <span class="n">group_by</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">harmonized_test</span><span class="o">.</span><span class="n">classes</span></a><span class="p">[</span><span class="s2">&quot;scan_site_id&quot;</span><span class="p">][</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">harmonized_test</span><span class="o">.</span><span class="n">y</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">group_by_name</span><span class="o">=</span><span class="s2">&quot;Site&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_hbn_site_profiles_003.png" srcset="../_images/sphx_glr_plot_hbn_site_profiles_003.png" alt="IFOL, UNCL, UNCR, IFOR, ATRL, CSTL, CSTR, ATRR, ARCL, SLFL, SLFR, ARCR, ILFL, CGCL, CGCR, ILFR, Orbital, AntFrontal, SupFrontal, Motor, SupParietal, Temporal, PostParietal, Occipital" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_hbn_site_profiles_004.png" srcset="../_images/sphx_glr_plot_hbn_site_profiles_004.png" alt="IFOL, UNCL, UNCR, IFOR, ATRL, CSTL, CSTR, ATRR, ARCL, SLFL, SLFR, ARCR, ILFL, CGCL, CGCR, ILFR, Orbital, AntFrontal, SupFrontal, Motor, SupParietal, Temporal, PostParietal, Occipital" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py:828: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py:828: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(

  0%|          | 0/2 [00:00&lt;?, ?it/s]

  0%|          | 0/24 [00:00&lt;?, ?it/s]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  4%|▍         | 1/24 [00:03&lt;01:23,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  8%|▊         | 2/24 [00:07&lt;01:20,  3.66s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 12%|█▎        | 3/24 [00:10&lt;01:16,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 17%|█▋        | 4/24 [00:14&lt;01:12,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 21%|██        | 5/24 [00:18&lt;01:09,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 25%|██▌       | 6/24 [00:21&lt;01:05,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 29%|██▉       | 7/24 [00:25&lt;01:02,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 33%|███▎      | 8/24 [00:29&lt;00:58,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 38%|███▊      | 9/24 [00:32&lt;00:54,  3.66s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 42%|████▏     | 10/24 [00:36&lt;00:51,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 46%|████▌     | 11/24 [00:40&lt;00:47,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 50%|█████     | 12/24 [00:43&lt;00:43,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 54%|█████▍    | 13/24 [00:47&lt;00:40,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 58%|█████▊    | 14/24 [00:51&lt;00:36,  3.66s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 62%|██████▎   | 15/24 [00:54&lt;00:32,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 67%|██████▋   | 16/24 [00:58&lt;00:29,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 71%|███████   | 17/24 [01:02&lt;00:26,  3.75s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 75%|███████▌  | 18/24 [01:06&lt;00:22,  3.73s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 79%|███████▉  | 19/24 [01:09&lt;00:18,  3.72s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 83%|████████▎ | 20/24 [01:13&lt;00:14,  3.70s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 88%|████████▊ | 21/24 [01:17&lt;00:11,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 92%|█████████▏| 22/24 [01:20&lt;00:07,  3.68s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 96%|█████████▌| 23/24 [01:24&lt;00:03,  3.67s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


100%|██████████| 24/24 [01:28&lt;00:00,  3.66s/it]
100%|██████████| 24/24 [01:28&lt;00:00,  3.67s/it]

 50%|█████     | 1/2 [01:29&lt;01:29, 89.06s/it]

  0%|          | 0/24 [00:00&lt;?, ?it/s]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  4%|▍         | 1/24 [00:03&lt;01:23,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


  8%|▊         | 2/24 [00:07&lt;01:21,  3.69s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 12%|█▎        | 3/24 [00:11&lt;01:17,  3.67s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 17%|█▋        | 4/24 [00:14&lt;01:13,  3.66s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 21%|██        | 5/24 [00:18&lt;01:09,  3.66s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 25%|██▌       | 6/24 [00:21&lt;01:05,  3.66s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 29%|██▉       | 7/24 [00:25&lt;01:02,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 33%|███▎      | 8/24 [00:29&lt;00:58,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 38%|███▊      | 9/24 [00:32&lt;00:54,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 42%|████▏     | 10/24 [00:36&lt;00:51,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 46%|████▌     | 11/24 [00:40&lt;00:47,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 50%|█████     | 12/24 [00:43&lt;00:43,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 54%|█████▍    | 13/24 [00:47&lt;00:40,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 58%|█████▊    | 14/24 [00:51&lt;00:36,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 62%|██████▎   | 15/24 [00:54&lt;00:32,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 67%|██████▋   | 16/24 [00:58&lt;00:29,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 71%|███████   | 17/24 [01:02&lt;00:25,  3.64s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 75%|███████▌  | 18/24 [01:05&lt;00:21,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 79%|███████▉  | 19/24 [01:09&lt;00:18,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 83%|████████▎ | 20/24 [01:12&lt;00:14,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 88%|████████▊ | 21/24 [01:16&lt;00:10,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 92%|█████████▏| 22/24 [01:20&lt;00:07,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


 96%|█████████▌| 23/24 [01:23&lt;00:03,  3.65s/it]/opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/afqinsight/plot.py:269: FutureWarning:

The `ci` parameter is deprecated. Use `errorbar=(&#39;ci&#39;, 95.0)` for the same effect.

  _ = sns.lineplot(


100%|██████████| 24/24 [01:27&lt;00:00,  3.65s/it]
100%|██████████| 24/24 [01:27&lt;00:00,  3.65s/it]

100%|██████████| 2/2 [02:57&lt;00:00, 88.79s/it]
100%|██████████| 2/2 [02:57&lt;00:00, 88.83s/it]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (6 minutes 31.562 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-hbn-site-profiles-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/59b2ef974e8631cfc6f5cd750f2eebbd/plot_hbn_site_profiles.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_hbn_site_profiles.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4089326b1079478b20ded0a482f170dd/plot_hbn_site_profiles.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_hbn_site_profiles.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c365a629c649fd5342fd604629ce73cf/plot_hbn_site_profiles.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_hbn_site_profiles.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">General examples</p>
      </div>
    </a>
    <a class="right-next"
       href="demo_afq_dataset.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Load and interact with an AFQ dataset</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fetch-the-hbn-data">Fetch the HBN data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-test-split">Train / test split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#impute-missing-values">Impute missing values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-average-bundle-profiles-by-scan-site">Plot average bundle profiles by scan site</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonize-the-sites-and-replot">Harmonize the sites and replot</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/auto_examples/plot_hbn_site_profiles.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020 -- , Adam Richie-Halford, Ariel Rokem, The University of Washington.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>